#To edit and compare internal_properties, use WINDEV integrated tools.
#Internal properties refer to the properties of controls in windows, reports, etc.
info :
 name : cOpenAI
 major_version : 29
 minor_version : 0
 type : 4
 description : ""
 subtype : 0
class :
 identifier : 0x16378f8a7e1c3679
 internal_properties : CQAAAAkAAAB2/vstTMCJbS/hlxjFxirSqKvCUuv8YxgpWyl7S3iA
 code_elements :
  type_code : 10
  p_codes :
   -
     code : |1-
      //*************************************************************************************************************************************************************************
      //Ce fichier fait partie de Betula.
      //Betula est un logiciel libre ; vous pouvez le redistribuer ou le modifier suivant les termes de la GNU Lesser General Public License telle que publiée par la Free Software Foundation ; soit la version 3 de la licence, soit (à votre gré) toute version ultérieure.
      //Betula est distribué dans l'espoir qu'il sera utile, mais SANS AUCUNE GARANTIE ; sans même la garantie tacite de QUALITÉ MARCHANDE ou d'ADÉQUATION à UN BUT PARTICULIER. Consultez la GNU Lesser General Public License pour plus de détails.
      //Vous devez avoir reçu une copie de la GNU Lesser General Public License en même temps que Betula ; si ce n'est pas le cas, consultez <http://www.gnu.org/licenses>.
      //
      //This file is part of Betula.
      //Betula is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.
      //Betula is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
      //You should have received a copy of the GNU Lesser General Public License along with Betula. If not, see <https://www.gnu.org/licenses/>
      //*************************************************************************************************************************************************************************
      
      //Cette classe permet d'interroger les services de OpenAI.
      //Attention : d'abord s'inscrire sur https://chatgpt.com/ et créer une clé API via https://platform.openai.com/api-keys. Attention, l'usage de l'API implique un paiement.
      
      cOpenAI est une Classe, abstraite
      hérite de chttpapi
      public constant
      	m_duTimeOut		est une durée		<serialise = faux>			//Durée après laquelle le timeout se déclenche
      PROTÉGÉ
      	m_vRéponse		est un variant		<serialise = faux>			//Réponse de l'appel API sous forme de variant
      privé
      	m_sCléAPI		est une chaine		<serialise = faux>			//Clé API pour accéder au service
      FIN
     type : 131072
  procedures :
   -
     name : Constructeur
     procedure_id : 1600906017537603193
     type_code : 27
     code : |1-
      // Résumé : Initialise une instance de la classe cOpenAI.
      // Syntaxe : Constructeur (<sURLDeBase> est chaîne, <sCléAPI> est chaîne [, <duTimeOut> est durée])
      // Paramètres :
      //	sCléAPI (chaîne UNICODE) : La clé API pour permettre l'accès au service
      //	duTimeOut (durée optionnelle) : Durée après laquelle le timeout se déclenche, par défaut : 5 secondes
      // Valeur de retour : Aucune
      // Exemple :
      //
      PROCEDURE Constructeur(sCléAPI est une chaine,duTimeOut est une durée = 5s)
      cHTTPAPI.Constructeur("https://api.openai.com/")	
      m_sCléAPI 	= sCléAPI
      m_duTimeOut	= duTimeOut
     type : 589824
   -
     name : Destructeur
     procedure_id : 1600906017537668729
     type_code : 28
     code : |1+
      // Résumé : <indiquez ici ce que fait la procédure>
      // Syntaxe :
      // Destructeur ()
      //
      // Paramètres :
      //	Aucun
      // Valeur de retour :
      // 	Aucune
      //
      // Exemple :
      // Indiquez ici un exemple d'utilisation.
      //
      PROCEDURE Destructeur()
      
     type : 655360
   -
     name : OpenAIRestExecute
     procedure_id : 1600906017537734265
     type_code : 12
     code : |1-
      // Résumé : Méthode protégée qui est utilisée pour effectuer une requête REST vers l'API OpenAI. Elle prend en charge la gestion des erreurs liées à la clé API et analyse la réponse reçue pour traiter les éventuelles erreurs renvoyées par l'API.
      // Syntaxe : [ <Résultat> = ] OpenAIRestExecute ()
      // Paramètres : Aucun
      // Valeur de retour : booléen : indique si la requête REST vers l'API OpenAI s'est terminée avec succès (Vrai) ou non (Faux).
      // Exemple :
      //
      PROCEDURE PROTÉGÉE OpenAIRestExecute() : booleen
      m_pclErreur.Raz()
      SI m_sCléAPI~="" 	ALORS m_pclErreur.AjouteErreur(<§$0000§>);renvoyer faux
      m_stRequêteHTTPAPI.nTimeOutConnexion	= m_duTimeOut
      m_stRequêteHTTPAPI.eMéthode				= cHTTP.HTTP_POST
      m_stRequêteHTTPAPI.sContentType			= chttp.typeMimeJSON
      
      SI RestExecute(cHTTPAPI.APIKey,"Bearer "+m_sCléAPI,*,*,"Authorization") ALORS
      	vRéponse 	est un variant 	= RéponseJSONUnicodeVersVariant()
      	si vRéponse.error..existe alors
      		m_pclErreur.AjouteErreur(vRéponse.error.message,vRéponse.error.code)
      	sinon
      		m_vRéponse 				= vRéponse
      		RENVOYER Vrai
      	FIN
      fin
      renvoyer faux
     type : 458752
  procedure_templates : []
  property_templates : []
 code_parameters :
  internal_properties : CQAAAAkAAACVGQgYbalU7DKC3oH4ItDrjtcTHXXV/EuH8q0IbhyQlw==
  original_name : Classe1
resources :
 string_res :
  identifier : 0x16378def7e04eede
  internal_properties : CQAAAAkAAACm76HWfKGWp33VjXInA4cRlqArlgTTA862QGt72W2ld5Y=
  strings :
   -
     text :
      fr-FR : La clé API est obligatoire
      en-GB : API key is mandatory
      fr-CA : La clé API est obligatoire
      en-US : API key is mandatory
     index : 0
custom_note :
 internal_properties : CQAAAAkAAABtB9HWVzrXO2+4NDRVK0vmzaNKrCKqH1DBX30lMmGZ
